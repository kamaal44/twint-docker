"use strict";

var _require = require("@babel/code-frame"),
    codeFrameColumns = _require.codeFrameColumns;

var _require2 = require("terser"),
    minify = _require2.minify;

function terser(userOptions) {
  var options = Object.assign({ sourceMap: true }, userOptions);

  return {
    name: "terser",

    transformBundle: function transformBundle(code) {
      var result = minify(code, options);
      if (result.error) {
        var _result$error = result.error,
            message = _result$error.message,
            line = _result$error.line,
            column = _result$error.col;

        console.error(codeFrameColumns(code, { start: { line: line, column: column } }, { message: message }));
        throw result.error;
      }
      return result;
    }
  };
}

exports.terser = terser;