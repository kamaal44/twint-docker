'use strict';

var path = require('path');
var fs = require('graceful-fs');
var stripBom = require('strip-bom');
var parseJson = require('parse-json');
var pify = require('pify');

var parse = function parse(data, fp) {
  return parseJson(stripBom(data), path.relative('.', fp));
};

module.exports = function (fp) {
  return pify(fs.readFile)(fp, 'utf8').then(function (data) {
    return parse(data, fp);
  });
};
module.exports.sync = function (fp) {
  return parse(fs.readFileSync(fp, 'utf8'), fp);
};